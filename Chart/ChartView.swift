//
//  ChartView.swift
//  Chart
//
//  Created by Shubham Kamdi on 10/4/25.
//
import SwiftUI
import Foundation

let dataPoints: [Double] = [50694.73475, 50693.80077, 50702.09415, 50686.53010, 50709.36274, 50690.49336, 50707.96714, 50707.14587, 50702.65296, 50701.05394, 50721.86365, 50706.99207, 50720.00934, 50709.53774, 50709.17906, 50729.34265, 50577.89226, 50561.99955, 50582.92559, 50584.80523, 50591.59068, 50568.66249, 50594.36841, 50594.05679, 50585.74585, 50592.60998, 50587.60993, 50604.92914, 50592.34327, 50610.68058, 50606.46134, 50591.02011, 50603.88972, 50606.30542, 50604.28857, 50609.54649, 50613.81796, 50621.06983, 50609.48520, 50621.65697, 50601.11879, 50627.59868, 50609.72992, 50628.74862, 50629.18681, 50633.14644, 50638.18361, 50631.59866, 50630.46302, 50633.16146, 50644.02882, 50643.16098, 50643.62713, 50638.37760, 50649.40979, 50645.30598, 50647.07933, 50648.65966, 50651.86566, 50653.81964, 50659.02293, 50660.60706, 50654.56665, 50648.16678, 50662.45969, 50665.18022, 50667.52426, 50667.12114, 50670.32131, 50667.44206, 50674.71474, 50689.10932, 50683.53674, 50674.83085, 50680.31181, 50673.62487, 50684.15937, 50690.44012, 50680.65231, 50694.73475, 50693.80077, 50702.09415, 50686.53010, 50709.36274, 50690.49336, 50707.96714, 50707.14587, 50702.65296, 50701.05394, 50721.86365, 50706.99207, 50720.00934, 50709.53774, 50709.17906, 50729.34265, 50718.28411, 50723.21852, 50725.76489, 50741.48487, 50719.83344, 50739, 50006.31651, 50019.45366, 50026.23972, 50037.41141, 50050.48154, 50061.01082, 50066.49217, 50078.22099, 50097.27679, 50103.55166, 50103.12474, 50116.67417, 50116.60739, 50112.05824, 50138.32345, 50140.19063, 50133.28074, 50155.50068, 50140.76204, 50159.24216, 50164.28812, 50175.26448, 50168.69661, 50189.67291, 50183.01715, 50191.47686, 50201.79456, 50198.55211, 50199.84280, 50201.24064, 50204.42769, 50205.02867, 50208.80303, 50218.42172, 50226.36199, 50218.22383, 50219.71694, 50236.63287, 50235.06180, 50242.91205, 50240.02505, 50246.02714, 50240.48472, 50246.11024, 50256.64248, 50261.83891, 50287.41821, 50281.04285, 50279.51317, 50277.25684, 50292.36203, 50295.29825, 50296.47355, 50300.34172, 50318.60533, 50300.96377, 50320.05043, 50327.17569, 50329.79717, 50343.49346, 50338.90221, 50362.74047, 50343.03907, 50360.58138, 50361.56921, 50369.26038, 50374.68768, 50385.10507, 50394.99298, 50398.74508, 50413.45215, 50422.82198, 50425.52702, 50425.87513, 50427.10743, 50438.20798, 50436.76783, 50449.59672, 50441.16241, 50461.00972, 50480.91495, 50468.32214, 50479.39333, 50469.27001, 50483.98589, 50476.95948, 50492.25952, 50494.85810, 50502.86147, 50501.25601, 50500.41838, 50503.47960, 50504.66188, 50511.64483, 50506.54442, 50517.55607, 50682.74275, 50672.72238, 50681.28851, 50696.39214, 50683.24558, 50701.20640, 50709.58702, 50715.56271, 50712.99751, 50709.39570, 50726.68695, 50703.02192, 50702.73854, 50723.38931, 50733.41491, 50725.03241, 50727.57605, 50726.60618, 50725.51958, 50737.12540, 50740.44045, 50525.05559, 50512.61634, 50526.42267, 50523.85248, 50522.49642, 50527.55374, 50527.54406, 50526.20161, 50519.28174, 50521.59222, 50546.13679, 50527.11162, 50568.42828, 50534.06013, 50542.22732, 50543.99167, 50537.12647, 50558.28316, 50557.98951, 50545.77695, 50564.53919, 50565.48100, 50571.01493, 50566.89992, 50568.66249, 50594.36841, 50594.05679, 50585.74585, 50592.60998, 50587.60993, 50604.92914, 50592.34327, 50610.68058, 50606.46134, 50599.46134, 50598.46134, 50577.46134, 50548.46134, 50400.46134,50570.70375, 50558.34055, 50582.47825, 50585.33272, 50583.09128, 50581.67476, 50584.41177, 50586.45554, 50599.20367, 50599.12522, 50600.95101, 50597.53715, 50599.33949, 50601.84439, 50613.26740, 50594.27389, 50604.79122, 50623.74862, 50623.44074, 50611.03896, 50628.39726, 50618.39495, 50631.63011, 50623.45813, 50635.02107, 50621.00402, 50647.22017, 50641.79960, 50625.30651, 50640.47043, 50650.43847, 50649.67760, 50646.82903, 50655.29733, 50647.47520, 50654.59506, 50656.82194, 50644.23065, 50668.24682, 50664.34064, 50662.24927, 50674.83148, 50660.06128, 50668.52768, 50667.85866, 50674.77693, 50683.33906, 50685.43020, 50684.80904, 50682.74275, 50672.72238, 50681.28851, 50696.39214, 50683.24558, 50701.20640, 50709.58702, 50715.56271, 50712.99751, 50709.39570, 50726.68695, 50703.02192, 50702.73854, 50723.38931, 50733.41491, 50725.03241, 50727.57605, 50726.60618, 50725.51958, 50737.12540, 50740.44045, 50738.20013, 50744.89227, 50745.86308, 50741.17075, 50743.42267, 50761.11341, 50750.74556, 50763.19782, 50749.79310, 50755.16096, 50755.54375, 50756.60061, 50755.49474, 50757.04782, 50785.26307, 50776.31992, 50767.72434, 50784.11325, 50782.97904, 50794.36766, 50776.30388, 50798.99386, 50790.94311, 50786.51472, 50791.15655, 50787.46375, 50805.66878, 50788.71433, 50815.15323, 50813.35277, 50807.80924, 50819.60611, 50816.87884, 50816.13505, 50814.92045, 50815.77116, 50829.23217, 50832.99206, 50821.74921, 50835.13268, 50830.10542, 50833.14404, 50833.21601, 50828.22519, 50842.02257, 50842.96037, 50839.69969, 50851.84437, 50848.58237, 50850.19913, 50861.35394, 50854.31678, 50855.20551, 50863.65311, 50879.37886, 50869.29818, 50859.58664, 50874.86979, 50866.98696, 50879.97039, 50882.20019, 50876.21249, 50878.76707, 50891.40186, 50885.63607, 50884.84152, 50909.40852, 50892.66037, 50899.43802, 50883.23646, 50894.38416, 50904.73536, 50910.45380, 50890.19963, 50910.62279, 50915.67222, 50898.87616, 50917.88548, 50937.32349, 50910.43812, 50931.33790, 50926.84756, 50944.23593, 50931.13867, 50940.73615, 50943.41075, 50961.07524, 50937.59961, 50940.28920, 50960.30794, 50952.79053, 50943.93037, 50954.86268, 50957.34088, 50969.36942, 50975.03171, 50963.10562, 50969.61072, 50966.18091, 50961.80576, 50952.46068, 50953.35571, 50938.99328, 50921.84810, 50911.64407, 50907.93406, 50887.82782, 50887.79906, 50870.92736, 50851.22962, 50846.64947, 50830.45998, 50825.42921, 50806.01850, 50805.80026, 50792.15322, 50777.58231, 50760.85834, 50752.46716, 50724.26225, 50732.51162, 50706.75928, 50713.68377, 50729.65937, 50736.52163, 50730.15817, 50723.33221, 50708.89230, 50727.05577, 50739.72580, 50725.48808, 50713.42885, 50713.00546, 50741.94824, 50709.91475, 50712.36631, 50737.97424, 50716.14547, 50728.83897, 50729.63368, 50727.06235, 50735.47321, 50715.90401, 50737.44258, 50716.47756, 50728.16546, 50709.44778, 50736.96194, 50749.95369, 50729.94710, 50718.82103, 50727.16218, 50716.26657, 50706.68929, 50720.15902, 50725.17694, 50722.44995, 50720.01742, 50735.88631, 50710.71433, 50732.84944, 50724.91983, 50715.72222, 50719.95394, 50713.59669, 50727.36770, 50733.62130, 50721.86632, 50725.33533, 50716.35424, 50723.54241, 50737.42929, 50711.00889, 50714.21299, 50715.84207, 50726.96879, 50716.18188, 50725.61101, 50715.91324, 50722.40401, 50729.78828, 50700.01776, 50715.77724, 50722.55742, 50721.99588, 50719.85569, 50713.78866, 50741.36089, 50719.47974, 50721.23590, 50729.50796, 50711.73582, 50721.72600, 50724.99561, 50723.42692, 50728.37806 ,50587.60993, 50604.92914, 50592.34327, 50610.68058, 50606.46134, 50591.02011, 50603.88972, 50606.30542, 50604.28857, 50609.54649, 50613.81796, 50621.06983, 50609.48520, 50621.65697, 50601.11879, 50627.59868, 50609.72992, 50628.74862, 50629.18681, 50633.14644, 50638.18361, 50631.59866, 50630.46302, 50633.16146, 50644.02882, 50643.16098, 50643.62713, 50638.37760, 50649.40979, 50645.30598, 50647.07933, 50648.65966, 50651.86566, 50653.81964, 50659.02293, 50660.60706, 50654.56665, 50648.16678, 50662.45969, 50665.18022, 50667.52426, 50667.12114, 50670.32131, 50667.44206, 50674.71474, 50689.10932, 50683.53674, 50674.83085, 50680.31181, 50673.62487, 50684.15937, 50690.44012, 50680.65231, 50694.73475, 50693.80077, 50702.09415, 50686.53010, 50709.36274, 50690.49336, 50707.96714, 50707.14587, 50702.65296, 50701.05394, 50721.86365, 50706.99207, 50720.00934, 50709.53774, 50709.17906, 50729.34265,50577.89226, 50561.99955, 50582.92559, 50584.80523, 50591.59068, 50568.66249, 50594.36841, 50594.05679, 50585.74585, 50592.60998, 50587.60993, 50604.92914, 50592.34327, 50610.68058, 50606.46134, 50599.46134, 50598.46134, 50577.46134, 50548.46134, 50400.46134]
let maxD = dataPoints.max()
let minD = dataPoints.min()

struct ChartView: View {
    let minY: Double
    let maxY: Double
    let data: [Double]
    let lineColor: Color
    init(minY: Double, maxY: Double, data: [Double]) {
        self.minY = minY
        self.maxY = maxY
        self.data = data
        let priceChange = (data.last ?? 0) - (data.first ?? 0)
        lineColor = priceChange > 0 ? Color.green : Color.red
    }
    var body: some View {
        VStack {
            chart
                .frame(height: 200)
                .background(chartBackground)
                .overlay (
                    charOverlay,
                    alignment: .leading
                )
        }
    }
    
    var charOverlay: some View {
        VStack() {
            Text(maxY.formatted())
            Spacer()
            Text(((maxY + minY)/2).formatted())
            Spacer()
            Text(minY.formatted())
        }
    }
    
    var chartBackground: some View {
        VStack {
            Divider()
            Spacer()
            Divider()
            Spacer()
            Divider()
        }
    }
    
    var chart: some View {
        GeometryReader {
            geometry in
            Path {
                path in
                for indexPoint in data.indices {
                    let xPosition = geometry.size.width / CGFloat(data.count) * CGFloat(indexPoint + 1)
                    let yAxis = maxY - minY
                    let yPosition = (1 - CGFloat((data[indexPoint] - minY) / yAxis)) * geometry.size.height
                    if (indexPoint == 0) {
                        path.move(to: CGPoint(x: xPosition, y: yPosition))
                    }
                    path.addLine(to: CGPoint(x:xPosition, y: yPosition))
                }
            }.stroke(lineColor, style: StrokeStyle(lineWidth: 2, lineCap: .round, lineJoin: .round))
                .shadow(color:lineColor, radius: 10, x: 0.0,y: 10)
                .shadow(color:lineColor.opacity(0.5), radius: 10, x: 0.0,y: 20)
                .shadow(color:lineColor.opacity(0.3), radius: 10, x: 0.0,y: 30)
                .shadow(color:lineColor.opacity(0.2), radius: 10, x: 0.0,y: 40)
                .shadow(color:lineColor.opacity(0.1), radius: 10, x: 0.0,y: 50)
        }
    }
}

struct ChartView_Previews: PreviewProvider {
    static var previews: some View {
        ChartView(minY: minD!,maxY: maxD!, data: dataPoints)
    }
}
